<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Sheep Jump Sleep</title>

<!-- ğŸŒ™ Google Analyticsï¼ˆGA4ï¼‰ -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X80FCDPMEW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-X80FCDPMEW', {
    anonymize_ip: true
  });
</script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #0e0e0e;
  overflow: hidden;
  user-select: none;
  font-family: -apple-system, BlinkMacSystemFont, "PingFang SC",
               "Helvetica Neue", Arial, sans-serif;
}

.container {
  position: relative;
  width: 100%;
  height: 100%;
}

/* ğŸªµ æ …æ ï¼ˆå›¾ç‰‡ç‰ˆï¼Œæœ‰è§’åº¦ï¼‰ */
.fence {
  position: absolute;
  top: 60%;
  left: 5%;
  width: 90%;
  height: 80px;

  background-image: url("fence.png");
  background-repeat: repeat-x;
  background-position: center bottom;
  background-size: auto 100%;

  pointer-events: none;
  transition: opacity 4s ease;
}

.fence.fade {
  opacity: 0.05;
}

/* ğŸ”¢ æ•°å­— */
.fence .number {
  position: absolute;
  top: -160px;
  width: 100%;
  text-align: center;

  font-size: 240px;
  color: #e6e6e6;
  opacity: 0;
  pointer-events: none;
}

.number.soft {
  animation: numberBreathSoft 3s ease-in-out forwards;
}

.number:not(.soft) {
  animation: numberBreath 3s ease-in-out forwards;
}

.number.sink {
  transform: translateY(40px);
}

/* ğŸ‘ ç¾Š */
.sheep {
  position: absolute;
  top: 50%;
  left: -30%;
  transform: translateY(-50%);
  pointer-events: none;
}

.sheep img {
  width: 120px;
}

.sheep img.nod {
  transform: rotate(4deg) translateY(2px);
}

.hint {
  position: absolute;
  bottom: 24px;
  width: 100%;
  text-align: center;
  font-size: 12px;
  opacity: 0.25;
}

/* ğŸ”¢ æ•°å­—å‘¼å¸ */
@keyframes numberBreath {
  0%   { opacity: 0; transform: scale(0.98); }
  30%  { opacity: 0; }
  45%  { opacity: 0.35; transform: scale(1); }
  70%  { opacity: 0.35; }
  100% { opacity: 0; transform: scale(0.98); }
}

@keyframes numberBreathSoft {
  0%   { opacity: 0; transform: scale(0.995); }
  30%  { opacity: 0; }
  45%  { opacity: 0.25; transform: scale(1); }
  70%  { opacity: 0.25; }
  100% { opacity: 0; transform: scale(0.995); }
}

/* ğŸ‘ è·³æ …æ  */
@keyframes sheepJumpFence {
  0%   { transform: translateX(0) translateY(8px) scale(0.98); }
  40%  { transform: translateX(45vw) translateY(0) scale(1); }
  50%  { transform: translateX(50vw) translateY(-80px) scale(1); }
  60%  { transform: translateX(55vw) translateY(0) scale(1); }
  72%  { transform: translateX(55vw) translateY(0) scale(1); }
  100% { transform: translateX(130vw) translateY(8px) scale(0.98); }
}
</style>
</head>

<body>
<div class="container">

  <!-- æ …æ  + æ•°å­— -->
  <div class="fence" id="fence">
    <div class="number" id="number">1</div>
  </div>

  <!-- ç¾Š -->
  <div class="sheep">
    <img id="sheepImg" src="sheep.png" alt="sheep" />
  </div>

  <div class="hint">ç‚¹å‡»ä»»æ„ä½ç½® æš‚åœ / ç»§ç»­</div>
</div>

<script>
let realNumber = 1;
let displayQueue = [];
let timer = null;
let running = true;

const numberEl = document.getElementById("number");
const fenceEl = document.getElementById("fence");
const sheepImg = document.getElementById("sheepImg");

const FINAL_STOP = 300;

/* åˆ¶é€ â€œé‡å¤é”™è§‰â€ */
function prepareDisplayQueue(n) {
  if (n >= 80 && Math.random() < 0.15) {
    const repeat = Math.random() < 0.5 ? 2 : 3;
    return Array(repeat).fill(n);
  }
  return [n];
}

function show() {
  if (realNumber > FINAL_STOP && displayQueue.length === 0) {
    stop();
    return;
  }

  if (displayQueue.length === 0) {
    displayQueue = prepareDisplayQueue(realNumber);
    realNumber++;
  }

  const displayNumber = displayQueue.shift();
  numberEl.textContent = displayNumber;

  numberEl.className = "number";
  sheepImg.classList.remove("nod");
  sheepImg.style.animation = "none";
  numberEl.style.animation = "none";
  void numberEl.offsetHeight;

  if (displayNumber >= 100) numberEl.classList.add("soft");
  if (displayNumber >= 120) numberEl.classList.add("sink");
  if (displayNumber >= 200) fenceEl.classList.add("fade");

  sheepImg.style.animation = "sheepJumpFence 3s linear forwards";

  setTimeout(() => sheepImg.classList.add("nod"), 1800);
  setTimeout(() => sheepImg.classList.remove("nod"), 2300);
}

function start() {
  show();
  timer = setInterval(show, 3000);
}

function stop() {
  clearInterval(timer);
}

document.body.addEventListener("click", () => {
  running = !running;
  running ? start() : stop();
});

start();
</script>
</body>
</html>
